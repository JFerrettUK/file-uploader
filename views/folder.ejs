<%- include('partials/header') %>

<h1><%= folder.name %></h1>

<h2>Create Subfolder</h2>
<form action="/create-folder" method="post">
  <div class="form-group">
    <label for="name">Folder Name:</label>
    <input type="text" id="name" name="name" class="form-control" required />
    <input type="hidden" name="parentId" value="<%= folder.id %>" />
  </div>
  <button type="submit" class="btn btn-primary">Create</button>
</form>

<h2>Files</h2>
<ul class="list-group">
  <% if (folder.files.length === 0) { %>
  <li class="list-group-item">No files in this folder.</li>
  <% } else { %> <% folder.files.forEach(file => { %>
  <li class="list-group-item">
    <a href="/files/<%= file.id %>"><%= file.filename %></a>
  </li>
  <% }); %> <% } %>
</ul>

<h2>Subfolders</h2>
<ul class="list-group">
  <% if (folder.children.length === 0) { %>
  <li class="list-group-item">No subfolders yet.</li>
  <% } else { %> <% folder.children.forEach(child => { %>
  <li class="list-group-item">
    <a href="/folders/<%= child.id %>"><%= child.name %></a>
    <form
      action="/folders/<%= child.id %>?_method=DELETE"
      method="post"
      class="d-inline"
    >
      <button type="submit" class="btn btn-danger btn-sm">Delete</button>
    </form>
  </li>
  <% }); %> <% } %>
</ul>
<br />
<form action="/upload" method="post" enctype="multipart/form-data">
  <input type="hidden" name="folderId" value="<%= folder.id %>" />
  <div class="form-group">
    <label for="file">Choose a file:</label>
    <input
      type="file"
      id="file"
      name="file"
      class="form-control-file"
      required
    />
  </div>
  <button type="submit" class="btn btn-primary">Upload</button>
</form>

<%- include('partials/footer') %>
